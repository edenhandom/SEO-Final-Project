<!-- templates/mood.html -->
{% extends "layout.html" %}

{% block content %}
<h2>Top Track Results</h2>

<form method="POST">
    <div class="form-group">
        <button type="submit" name="action" value="request_mood">Request Mood</button>
    </div>

    <div class="form-group">
        <input type="text" name="user_mood" placeholder="Enter your mood">
        <button type="submit" name="action" value="submit_mood">Submit Mood</button>
    </div>
</form>

<br>

{% if action == 'request_mood' and response %}
    <h2>Your mood is: {{ mood_response }}</h2>
    <p>Your recently played tracks:</p>
    <br>
    <table>
        {% for song in response %}
        <tr class="song">
            <td>
                <!-- Song Title -->
                <a class="bold" href="{{ song.link }}" target="_blank">{{ song.song }}</a>
                <br>
                <!-- Song Artist -->
                <i>{{ song.artist }}</i>
            </td>
            <!-- Song Preview -->
            <td>
                {% if song.preview_url %}
                    <div class="audio-container">
                        <button class="audio-button mono-font" onclick="togglePlay(this)">▶</button>
                        <audio preload="none">
                            <source src="{{ song.preview_url }}" type="audio/mpeg">
                            Your browser does not support the audio element.
                        </audio>
                        <span class="audio-time mono-font">0:00</span>
                    </div>
                {% else %}
                    No preview available
                {% endif %}
                <br>
            </td>
        </tr>
        {% endfor %}
    </table>
{% elif action == 'submit_mood' and response %}
    <p>Playlist based on your mood "{{ user_mood }}":</p>
    <br>
    <table>
        {% for song in response %}
        <tr class="song">
            <td>
                <!-- Song Title -->
                <a class="bold" href="{{ song.link }}" target="_blank">{{ song.song }}</a>
                <br>
                <!-- Song Artist -->
                <i>{{ song.artist }}</i>
            </td>
            <!-- Song Preview -->
            <td>
                {% if song.preview_url %}
                    <div class="audio-container">
                        <button class="audio-button mono-font" onclick="togglePlay(this)">▶</button>
                        <audio preload="none">
                            <source src="{{ song.preview_url }}" type="audio/mpeg">
                            Your browser does not support the audio element.
                        </audio>
                        <span class="audio-time mono-font">0:00</span>
                    </div>
                {% else %}
                    No preview available
                {% endif %}
                <br>
            </td>
        </tr>
        {% endfor %}
    </table>
{% endif %}

<br><br>

<div class="return-buttons">
    <a class="button" href="{{ url_for('home') }}">Return Home</a>
</div>

{% endblock %}
